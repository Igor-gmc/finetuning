# –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∑–∞–ø—É—Å–∫—É –ø—Ä–æ–µ–∫—Ç–∞

## üìã –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

–ü—Ä–æ–µ–∫—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –¥–≤—É—Ö –ø–æ–¥—Ö–æ–¥–æ–≤ –∫ —Å–æ–∑–¥–∞–Ω–∏—é AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞ –¥–ª—è –ø—Ä–æ–¥–≤–∏–∂–µ–Ω–∏—è –∫—É—Ä—Å–æ–≤ –£–ò–ò:
1. **RAG** (Retrieval-Augmented Generation) —Å Qdrant + –±–∞–∑–æ–≤–∞—è –º–æ–¥–µ–ª—å Qwen
2. **Fine-tuning** –º–æ–¥–µ–ª–∏ Qwen –Ω–∞ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –¥–∞—Ç–∞—Å–µ—Ç–µ

## üîß –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

### 1. –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
# –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
python -m venv venv

# –ê–∫—Ç–∏–≤–∞—Ü–∏—è
# –ù–∞ macOS/Linux:
source venv/bin/activate
# –ù–∞ Windows:
venv\Scripts\activate
```

### 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫

```bash
pip install -r requirements.txt
```

**–í–∞–∂–Ω–æ**:
- –¢—Ä–µ–±—É–µ—Ç—Å—è Python 3.8+
- –î–ª—è —Ä–∞–±–æ—Ç—ã —Å –∫–≤–∞–Ω—Ç–∏–∑–∞—Ü–∏–µ–π (bitsandbytes) –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è CUDA (–¥–ª—è GPU)
- –ù–∞ macOS –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å MPS (Metal Performance Shaders)

## üîë –ù–∞—Å—Ç—Ä–æ–π–∫–∞ API –∫–ª—é—á–µ–π

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–∞–π–ª `.env` —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã:

```env
HF_TOKEN=–≤–∞—à_—Ç–æ–∫–µ–Ω_huggingface
OPENAI_API_KEY=–≤–∞—à_–∫–ª—é—á_openai
```

- `HF_TOKEN` - —Ç–æ–∫–µ–Ω –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –º–æ–¥–µ–ª—è–º Qwen –Ω–∞ HuggingFace
- `OPENAI_API_KEY` - API –∫–ª—é—á –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —á–µ—Ä–µ–∑ GPT-4o-mini

## üöÄ –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞

### –ü–æ–ª–Ω—ã–π –∑–∞–ø—É—Å–∫ –≤—Å–µ—Ö –∑–∞–¥–∞—á

```bash
python main.py
```

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –≤—ã–ø–æ–ª–Ω–∏—Ç –≤—Å–µ 4 —à–∞–≥–∞:
1. ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ RAG –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö —Å Qdrant
2. ‚úÖ Fine-tuning –º–æ–¥–µ–ª–∏ Qwen (–Ω–∞ 1000 –ø—Ä–∏–º–µ—Ä–∞—Ö)
3. ‚úÖ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–æ–≤ –æ–±–æ–∏–º–∏ –º–µ—Ç–æ–¥–∞–º–∏ –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ã–µ –≤–æ–ø—Ä–æ—Å—ã
4. ‚úÖ –ê–Ω–∞–ª–∏–∑ –∫–∞—á–µ—Å—Ç–≤–∞ –æ—Ç–≤–µ—Ç–æ–≤ —á–µ—Ä–µ–∑ GPT-4o-mini

### –û—Ç–¥–µ–ª—å–Ω—ã–µ –º–æ–¥—É–ª–∏

#### –¢–æ–ª—å–∫–æ RAG —Å–∏—Å—Ç–µ–º–∞
```bash
python rag_system.py
```

#### –¢–æ–ª—å–∫–æ Fine-tuning
```bash
python fine_tuning.py
```

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

–ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã —Å–∫—Ä–∏–ø—Ç–∞ –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω —Ñ–∞–π–ª **`result.txt`**, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç:

1. **–û—Ç–≤–µ—Ç—ã RAG —Å–∏—Å—Ç–µ–º—ã** –Ω–∞ –≤—Å–µ —Ç–µ—Å—Ç–æ–≤—ã–µ –≤–æ–ø—Ä–æ—Å—ã
2. **–û—Ç–≤–µ—Ç—ã Fine-tuned –º–æ–¥–µ–ª–∏** –Ω–∞ —Ç–µ –∂–µ –≤–æ–ø—Ä–æ—Å—ã
3. **–î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –æ—Ç GPT-4o-mini** —Å –æ—Ü–µ–Ω–∫–æ–π –∫–∞—á–µ—Å—Ç–≤–∞ –æ–±–æ–∏—Ö –ø–æ–¥—Ö–æ–¥–æ–≤

–§–æ—Ä–º–∞—Ç result.txt:
```
RAG (Retrieval-Augmented Generation) Qdrant + Qwen2.5-1.5B-Instruct –±–µ–∑ Fine-tuning
========================
–í–æ–ø—Ä–æ—Å 1: ...
–û—Ç–≤–µ—Ç 1: ...
========================
...

Qwen2.5-1.5B-Instruct + Fine-tuning
========================
–í–æ–ø—Ä–æ—Å 1: ...
–û—Ç–≤–µ—Ç 1: ...
========================
...

–ê–ù–ê–õ–ò–ó –ö–ê–ß–ï–°–¢–í–ê –û–¢–í–ï–¢–û–í (GPT-4o-mini)
========================
[–î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑]
```

## üéØ –¢–µ—Å—Ç–æ–≤—ã–µ –≤–æ–ø—Ä–æ—Å—ã

–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è:

1. "–ü—Ä–∏–≤–µ—Ç, –∞ —á—Ç–æ —Ç–∞–∫–æ–µ –∫—É—Ä—Å CHATGPT PROFESSIONAL –∏ –µ–≥–æ —Å—Ç–æ–∏–º–æ—Å—Ç—å?"
2. "–ü—Ä–∏–≤–µ—Ç, –∞ –∫–∞–∫–∏–µ –∫—É—Ä—Å—ã –µ—Å—Ç—å –ø–æ Python?"
3. "–ö–∞–∫–∏–µ –µ—Å—Ç—å –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫—É—Ä—Å–æ–≤ —É –£–ò–ò?"
4. "–°–∫–æ–ª—å–∫–æ –ø–æ –≤—Ä–µ–º–µ–Ω–∏ —É—á–∏—Ç—å—Å—è –Ω–∞ –∫—É—Ä—Å–µ –ø–æ GPT?"
5. "–ï—Å—Ç—å —Ç—Ä—É–¥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –ø–æ—Å–ª–µ –æ–±—É—á–µ–Ω–∏—è?"

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

### Fine-tuning –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

–í —Ñ–∞–π–ª–µ `fine_tuning.py` –º–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å:
- `max_samples` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–∏–º–µ—Ä–æ–≤ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 1000)
- `num_train_epochs` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ø–æ—Ö –æ–±—É—á–µ–Ω–∏—è (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 3)
- `learning_rate` - —Å–∫–æ—Ä–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 2e-4)

### RAG –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

–í —Ñ–∞–π–ª–µ `rag_system.py` –º–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å:
- `top_k` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –¥–ª—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 3)
- `embedding_model` - –º–æ–¥–µ–ª—å –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤

## üóÇÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
project/
‚îú‚îÄ‚îÄ main.py                  # –ì–ª–∞–≤–Ω—ã–π —Å–∫—Ä–∏–ø—Ç
‚îú‚îÄ‚îÄ rag_system.py           # RAG —Å–∏—Å—Ç–µ–º–∞ —Å Qdrant
‚îú‚îÄ‚îÄ fine_tuning.py          # Fine-tuning –º–æ–¥–µ–ª–∏
‚îú‚îÄ‚îÄ requirements.txt        # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ selected_qa_full.csv    # –î–∞—Ç–∞—Å–µ—Ç –¥–ª—è –æ–±—É—á–µ–Ω–∏—è
‚îú‚îÄ‚îÄ .env                    # API –∫–ª—é—á–∏ (–Ω–µ –∫–æ–º–º–∏—Ç–∏—Ç—Å—è)
‚îú‚îÄ‚îÄ .gitignore             # –ü—Ä–∞–≤–∏–ª–∞ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏—è
‚îú‚îÄ‚îÄ readme.md              # –û–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏
‚îú‚îÄ‚îÄ INSTRUCTIONS.md        # –≠—Ç–∞ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è
‚îî‚îÄ‚îÄ result.txt             # –†–µ–∑—É–ª—å—Ç–∞—Ç—ã (—Å–æ–∑–¥–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞)
```

## ‚ö†Ô∏è –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

### 1. –û—à–∏–±–∫–∞ "CUDA out of memory"
- –£–º–µ–Ω—å—à–∏—Ç–µ `max_samples` –≤ `main.py`
- –£–º–µ–Ω—å—à–∏—Ç–µ `per_device_train_batch_size` –≤ `fine_tuning.py`
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ CPU (–º–µ–¥–ª–µ–Ω–Ω–µ–µ, –Ω–æ –Ω–∞–¥–µ–∂–Ω–µ–µ)

### 2. –û—à–∏–±–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –º–æ–¥–µ–ª–∏ Qwen
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å `HF_TOKEN` –≤ `.env`
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É –≤–∞—Å –µ—Å—Ç—å –¥–æ—Å—Ç—É–ø –∫ –º–æ–¥–µ–ª–∏ –Ω–∞ HuggingFace

### 3. –î–æ–ª–≥–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
- Fine-tuning –Ω–∞ 1000 –ø—Ä–∏–º–µ—Ä–∞—Ö: ~30-60 –º–∏–Ω—É—Ç (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∂–µ–ª–µ–∑–∞)
- –ü–æ–ª–Ω—ã–π –∑–∞–ø—É—Å–∫: ~1-2 —á–∞—Å–∞
- –î–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è —É–º–µ–Ω—å—à–∏—Ç–µ `max_samples`

### 4. –û—à–∏–±–∫–∞ bitsandbytes –Ω–∞ macOS
- –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ bitsandbytes –º–æ–∂–µ—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞ macOS
- –†–µ—à–µ–Ω–∏–µ: –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `load_in_8bit=True` –≤–º–µ—Å—Ç–æ `load_in_4bit=True`
- –ò–ª–∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –Ω–∞ Linux/Windows —Å CUDA

## üìà –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

–ü–æ—Å–ª–µ –∞–Ω–∞–ª–∏–∑–∞ GPT-4o-mini –≤—ã –ø–æ–ª—É—á–∏—Ç–µ:
- –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ç–æ—á–Ω–æ—Å—Ç–∏ –∏ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏ –æ—Ç–≤–µ—Ç–æ–≤
- –û—Ü–µ–Ω–∫—É –º–æ—Ç–∏–≤–∏—Ä—É—é—â–∏—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –¥–ª—è –ø—Ä–æ–¥–∞–∂
- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –≤—ã–±–æ—Ä—É –ø–æ–¥—Ö–æ–¥–∞
- –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –ø–æ —É–ª—É—á—à–µ–Ω–∏—é

## üí° –°–æ–≤–µ—Ç—ã –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

1. **–ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫**: –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å `max_samples=100` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏, —á—Ç–æ –≤—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
2. **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π**: Fine-tuned –º–æ–¥–µ–ª—å —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ `./qwen_finetuned/`
3. **–ü–æ–≤—Ç–æ—Ä–Ω—ã–π –∑–∞–ø—É—Å–∫**: –µ—Å–ª–∏ –º–æ–¥–µ–ª—å —É–∂–µ –æ–±—É—á–µ–Ω–∞, –æ–Ω–∞ –Ω–µ –±—É–¥–µ—Ç –ø–µ—Ä–µ–æ–±—É—á–∞—Ç—å—Å—è
4. **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ**: HuggingFace –∫—ç—à–∏—Ä—É–µ—Ç –º–æ–¥–µ–ª–∏ –≤ `~/.cache/huggingface/`

## üìù –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

- –ú–æ–¥–µ–ª—å: Qwen2.5-1.5B-Instruct —Å INT4 –∫–≤–∞–Ω—Ç–∏–∑–∞—Ü–∏–µ–π
- RAG: Qdrant (in-memory) + SentenceTransformers
- Fine-tuning: LoRA (Low-Rank Adaptation)
- –ê–Ω–∞–ª–∏–∑: GPT-4o-mini –æ—Ç OpenAI

## ü§ù –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–ª–∏—á–∏–µ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–≥–æ –º–µ—Å—Ç–∞ –Ω–∞ –¥–∏—Å–∫–µ (~10GB)
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å API –∫–ª—é—á–µ–π
